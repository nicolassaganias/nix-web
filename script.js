// Traducciones
const translations = {
    es: {
        // NavegaciÃ³n
        home: "home",
        projects: "proyectos",
        contact: "contacto",
        about: "about",
        services: "servicios",
        language: "idioma",

        // Home
        title: "Desarrollos TecnolÃ³gicos",
        subtitle: "Creo experiencias interactivas que conectan lo digital con lo fÃ­sico",
        description: "Mi trabajo explora la intersecciÃ³n entre tecnologÃ­a, arte y educaciÃ³n, desarrollando soluciones innovadoras que transforman la forma en que interactuamos con nuestro entorno.",

        // Secciones home
        whatIDo: "Â¿quÃ© hago?",
        whatIDoText: "Desarrollo hardware y software personalizado, creo tecnologÃ­as conviviales y sistemas interactivos. Me especializo en formaciones, digitalizaciÃ³n de procesos, adquisiciÃ³n y anÃ¡lisis de datos, interfaces humano-mÃ¡quina, automatizaciÃ³n, prototipado rÃ¡pido, integraciÃ³n de sensores y actuadores, y soluciones creativas para artistas y educadores.",
        whoIAm: "Â¿quiÃ©n soy?",
        whoIAmText: "Utilizo sensores, microcontroladores y algoritmos para desarrollar sistemas que dialogan con su entorno y con las personas que los habitan. Mi enfoque siempre busca hacer visible lo invisible, ya sea a travÃ©s de datos ambientales, procesos biolÃ³gicos o comportamientos emergentes en sistemas complejos.",
        recentProjects: "proyectos recientes",
        seeAllProjects: "Ver Todos los Proyectos",
        knowMyServices: "Conocer Mis Servicios",
        
        // Home highlights
        highlightScience: "Ciencia & InvestigaciÃ³n",
        highlightArt: "Arte Interactivo",
        highlightDevelopments: "Desarrollos a Medida",
        highlightSustainability: "Sostenibilidad",
        
        // Home CTA buttons
        ctaProjects: "Proyectos",
        ctaServices: "Servicios",
        
        // Scrolling text
        scrollingScience: "CIENCIA",
        scrollingArt: "ARTE",
        scrollingEducation: "EDUCACIÃ“N",
        scrollingIot: "IOT",
        scrollingSoftware: "SOFTWARE-HARDWARE",
        scrollingSensors: "SENSORIZACIÃ“N",
        scrollingDigital: "DIGITALIZACIÃ“N",
        scrollingPrototyping: "PROTOTIPADO",
        scrollingOpenSource: "OPEN-SOURCE",
        scrollingDiy: "DIY-DIWO",
        scrollingDomotics: "DOMÃ“TICA",
        scrollingEmbedded: "SISTEMAS-EMBEBIDOS",
        scrollingResearch: "INVESTIGACIÃ“N",

        // PÃ¡ginas
        projectsTitle: "Proyectos",
        projectsIntro: "Desarrollos de software y hardware personalizado. Sensores, adquisiciÃ³n de datos, digitalizaciÃ³n. Traducciones analÃ³gico-digital / digital-analÃ³gico. Interfaces humano - mÃ¡quina. TecnologÃ­as conviviales, open-source, open-hard.",
        servicesTitle: "Servicios",
        servicesIntro: "Ofrezco servicios especializados en el desarrollo de soluciones tecnolÃ³gicas personalizadas, integrando hardware y software para crear experiencias Ãºnicas y sistemas funcionales.",
        contactTitle: "Contacto",
        aboutTitle: "About",

        // Servicios
        scienceResearch: "Ciencia & InvestigaciÃ³n",
        scienceResearchText: "Prototipos y sistemas experimentales con sensores personalizados, adquisiciÃ³n de datos y conectividad para investigaciÃ³n cientÃ­fica.",
        digitalArt: "Arte Digital e Interactivo",
        digitalArtText: "Desarrollo de soluciones tecnolÃ³gicas personalizadas para artistas que quieren incorporar elementos interactivos, sensores o sistemas de control en sus obras.",
        developments: "Desarrollos",
        developmentsText: "Desarrollos artÃ­sticos que combinan tecnologÃ­a, sensores y actuadores con una mirada estÃ©tica y aportes creativos. Desarrollo de soluciones para artistas que quieran encargar una parte de alguna pieza o el montaje/ etc soluciones creativas para artistas que quieren incorporar algo tecnolÃ³gico en su obra. TambiÃ©n tengo experiencia en montaje.",
        sustainability: "Sostenibilidad y EducaciÃ³n",
        sustainabilityText: "Sistemas educativos interactivos y herramientas de monitoreo ambiental. Desarrollo de experiencias de aprendizaje que conectan tecnologÃ­a con conciencia ecolÃ³gica.",

        // Tags
        filterByTags: "Filtrar por tags",

        // Contacto
        email: "Email",
        portfolioArt: "Portfolio Arte",
        name: "Nombre",
        message: "Mensaje",
        send: "Enviar",
        
        // Proyectos
        technicalSpecs: "Especificaciones TÃ©cnicas:",
        noProjectsFound: "No hay proyectos que coincidan con los filtros seleccionados."
    },
    en: {
        // NavegaciÃ³n
        home: "home",
        projects: "projects",
        contact: "contact",
        about: "about",
        services: "services",
        language: "language",

        // Home
        title: "Technological Developments",
        subtitle: "I create interactive experiences that connect digital with physical",
        description: "My work explores the intersection between technology, art and education, developing innovative solutions that transform how we interact with our environment.",

        // Secciones home
        whatIDo: "what do i do?",
        whatIDoText: "I develop custom hardware and software, create convivial technologies and interactive systems. I specialize in training, process digitization, data acquisition and analysis, human-machine interfaces, automation, rapid prototyping, sensor and actuator integration, and creative solutions for artists and educators.",
        whoIAm: "who am i?",
        whoIAmText: "I use sensors, microcontrollers and algorithms to develop systems that dialogue with their environment and with the people who inhabit them. My approach always seeks to make the invisible visible, whether through environmental data, biological processes or emergent behaviors in complex systems.",
        recentProjects: "recent projects",
        seeAllProjects: "See All Projects",
        knowMyServices: "Know My Services",
        
        // Home highlights
        highlightScience: "Science & Research",
        highlightArt: "Interactive Art",
        highlightDevelopments: "Custom Developments",
        highlightSustainability: "Sustainability",
        
        // Home CTA buttons
        ctaProjects: "Projects",
        ctaServices: "Services",
        
        // Scrolling text
        scrollingScience: "SCIENCE",
        scrollingArt: "ART",
        scrollingEducation: "EDUCATION",
        scrollingIot: "IOT",
        scrollingSoftware: "SOFTWARE-HARDWARE",
        scrollingSensors: "SENSORIZATION",
        scrollingDigital: "DIGITIZATION",
        scrollingPrototyping: "PROTOTYPING",
        scrollingOpenSource: "OPEN-SOURCE",
        scrollingDiy: "DIY-DIWO",
        scrollingDomotics: "HOME AUTOMATION",
        scrollingEmbedded: "EMBEDDED SYSTEMS",
        scrollingResearch: "RESEARCH",

        // PÃ¡ginas
        projectsTitle: "Projects",
        projectsIntro: "Custom software and hardware development. Sensors, data acquisition, digitization. Analog-digital / digital-analog translations. Human-machine interfaces. Convivial technologies, open-source, open-hardware.",
        servicesTitle: "Services",
        servicesIntro: "I offer specialized services in the development of customized technological solutions, integrating hardware and software to create unique experiences and functional systems.",
        contactTitle: "Contact",
        aboutTitle: "About",

        // Servicios
        scienceResearch: "Science & Research",
        scienceResearchText: "Prototypes and experimental systems with custom sensors, data acquisition and connectivity for scientific research.",
        digitalArt: "Digital & Interactive Art",
        digitalArtText: "Development of customized technological solutions for artists who want to incorporate interactive elements, sensors or control systems in their works.",
        developments: "Developments",
        developmentsText: "Artistic developments that combine technology, sensors and actuators with an aesthetic vision and creative contributions. Development of solutions for artists who want to commission a part of a piece or the assembly/ etc creative solutions for artists who want to incorporate something technological in their work. I also have experience in assembly.",
        sustainability: "Sustainability & Education",
        sustainabilityText: "Interactive educational systems and environmental monitoring tools. Development of learning experiences that connect technology with ecological awareness.",

        // Tags
        filterByTags: "Filter by tags",

        // Contacto
        email: "Email",
        portfolioArt: "Art Portfolio",
        name: "Name",
        message: "Message",
        send: "Send",
        
        // Proyectos
        technicalSpecs: "Technical Specifications:",
        noProjectsFound: "No projects match the selected filters."
    }
};

// Idioma actual
let currentLanguage = 'es';

// Ruta base para las imÃ¡genes
const IMG_BASE = 'images/';

// FunciÃ³n helper para obtener texto traducido de un proyecto
function getProjectText(project, field) {
    if (currentLanguage === 'en' && project[field + 'En']) {
        return project[field + 'En'];
    }
    return project[field];
}

// Proyectos NIX (curados + actualizados)
const projects = [
    {
        id: 16,
        title: "GAD",
        description: "Sistema IoT para monitoreo y control inteligente de tanques de agua.",
        descriptionEn: "IoT system for intelligent monitoring and control of water tanks.",
        image: IMG_BASE + "GADMain.jpeg",
        tags: ["ciencia", "iot", "sostenibilidad", "desarrollos"],
        details:
            "GAD es un sistema de gestiÃ³n de agua que combina sensores de ultrasonido y caudalÃ­metros para medir nivel y consumo en tanques domÃ©sticos o de edificios. Los datos se envÃ­an a una plataforma central en lÃ­nea, desde la que se puede controlar de forma remota la apertura y cierre de la electrovÃ¡lvula de carga. Esto permite optimizar el uso del recurso, prevenir desabastecimientos y responder rÃ¡pidamente a fugas o consumos inusuales. El diseÃ±o incluye mÃ³dulos autÃ³nomos basados en ESP32 que se acoplan directamente a los tanques, con electrÃ³nica protegida y comunicaciÃ³n estable para contextos urbanos o zonas con escasez hÃ­drica.",
        detailsEn:
            "GAD is a water management system that combines ultrasonic sensors and flow meters to measure level and consumption in domestic or building tanks. Data is sent to an online central platform, from which the loading solenoid valve can be remotely controlled. This allows optimizing resource use, preventing shortages, and quickly responding to leaks or unusual consumption. The design includes autonomous modules based on ESP32 that attach directly to tanks, with protected electronics and stable communication for urban contexts or areas with water scarcity.",
        specs: [
            "MCU: ESP32 con conectividad WiFi",
            "Sensores: ultrasonido para nivel y caudalÃ­metros para consumo",
            "Actuadores: electrovÃ¡lvula para carga controlada",
            "Plataforma: gestiÃ³n remota online basada en Firebase",
            "AplicaciÃ³n: optimizaciÃ³n y control inteligente del agua"
        ],
        specsEn: [
            "MCU: ESP32 with WiFi connectivity",
            "Sensors: ultrasound for level and flow meters for consumption",
            "Actuators: solenoid valve for controlled loading",
            "Platform: online remote management based on Firebase",
            "Application: optimization and intelligent water control"
        ],
        date: "2025-01-10"
    },
    {
        id: 15,
        title: "Flapp",
        description: "Plataforma BLE + app mÃ³vil para registrar parÃ¡metros del agua en laboratorio.",
        descriptionEn: "BLE platform + mobile app to record water parameters in the laboratory.",
        image: IMG_BASE + "FlappMain.jpg",
        tags: ["ciencia", "iot", "investigaciÃ³n", "sostenibilidad", "desarrollos"],
        details:
            "Sistema modular y low-cost de adquisiciÃ³n para ensayos con membranas (Ã³smosis inversa/directa) u otros procesos fÃ­sico-quÃ­micos. ESP32 alimentado por baterÃ­a con sensÃ³rica intercambiable. App Flutter (Android/iOS) para visualizar tiempo real, registrar y exportar datos.",
        detailsEn:
            "Modular and low-cost acquisition system for membrane tests (reverse/direct osmosis) or other physical-chemical processes. Battery-powered ESP32 with interchangeable sensors. Flutter app (Android/iOS) to visualize real-time, record and export data.",
        specs: [
            "MCU: ESP32",
            "App: Flutter (BT Low Energy)",
            "Sensores: pH, EC, ORP, presiÃ³n, peso",
            "ExportaciÃ³n: .csv",
            "Uso: laboratorio/field portable"
        ],
        specsEn: [
            "MCU: ESP32",
            "App: Flutter (BT Low Energy)",
            "Sensors: pH, EC, ORP, pressure, weight",
            "Export: .csv",
            "Use: laboratory/field portable"
        ],
        date: "2025-02-01"
    },
    {
        id: 19,
        title: "LIFE",
        description: "Monitoreo industrial para aguas grises con PLC Opta y reportes diarios online.",
        descriptionEn: "Industrial monitoring for greywater with Opta PLC and daily online reports.",
        image: IMG_BASE + "LIFEMain.jpg",
        tags: ["ciencia", "iot", "investigaciÃ³n", "sostenibilidad", "desarrollos"],
        details:
            "ImplementaciÃ³n para el proyecto europeo LIFE BIODAPH2O: diseÃ±o y despliegue de un sistema robusto de adquisiciÃ³n y envÃ­o de datos en infraestructura real de aguas grises. ConexiÃ³n de >10 sensores (pH, OD, temp., turbidez, conductividad, caudal) a un PLC Arduino Opta + expansiÃ³n. Registros en tiempo real y envÃ­o de reportes .csv diarios a los equipos de investigaciÃ³n; comunicaciÃ³n por WiFi/4G y  MQTT para integraciÃ³n remota. Cableado y puesta en marcha con criterios industriales (bajo mantenimiento/alta disponibilidad).",
        detailsEn:
            "Implementation for the European LIFE BIODAPH2O project: design and deployment of a robust data acquisition and transmission system in real greywater infrastructure. Connection of >10 sensors (pH, OD, temp., turbidity, conductivity, flow) to an Arduino Opta PLC + expansion. Real-time logging and daily .csv report sending to research teams; WiFi/4G and MQTT communication for remote integration. Wiring and commissioning with industrial criteria (low maintenance/high availability).",
        specs: [
            "PLC: Arduino Opta + expansiÃ³n",
            "Entradas: 4â€“20 mA / 0â€“10 V",
            "Sensores: pH, OD, turbidez, EC, caudal, temp.",
            "Comms: WiFi 4G, MQTT",
            "AutomatizaciÃ³n: reportes .csv diarios"
        ],
        specsEn: [
            "PLC: Arduino Opta + expansion",
            "Inputs: 4â€“20 mA / 0â€“10 V",
            "Sensors: pH, OD, turbidity, EC, flow, temp.",
            "Comms: WiFi 4G, MQTT",
            "Automation: daily .csv reports"
        ],
        date: "2025-03-15"
    },
    {
        id: 1,
        title: "Cerbero",
        description: "Ser hÃ­brido de caÃ±as, luz, sonido y sensores que reacciona a rayos cÃ³smicos (muones).",
        image: IMG_BASE + "cerberoMain.JPG",
        tags: ["arte", "ciencia"],
        details:
            "InstalaciÃ³n interactiva que reimagina al guardiÃ¡n del inframundo como criatura tecno-orgÃ¡nica. Un sensor de rayos cÃ³smicos activa sonido, vibraciÃ³n e iluminaciÃ³n LED en una estructura de materiales naturales. Aborda el â€˜subsueloâ€™ como mito, territorio y psique: lo que late bajo la superficie y lo invisible que nos atraviesa.",
        specs: [
            "Sensor: detecciÃ³n de muones DIY ('Cosmic Watch, MIT')",
            "ActuaciÃ³n: transductores + altavoces",
            "IluminaciÃ³n: LED integrada",
            "Control: Arduino/microcontroladores",
            "Estructura: caÃ±as + arena"
        ],
        date: "2024-02-01"
    },
    {
        id: 14,
        title: "Faktor",
        description: "Bomba de fluido fluorescente sincronizada con video.",
        image: IMG_BASE + "FaktorMain.jpg",
        tags: ["arte", "desarrollos", "video"],
        details:
            "InstalaciÃ³n desarrollada para 'Cuando dejamos de entender el mundo' (Faktor, MilÃ¡n). Circuito de mangueras con lÃ­quido fluorescente cuyo flujo se sincroniza con una pieza de video. Control integral desde Raspberry Pi con scripts para timing, autonomÃ­a y robustez in-situ.",
        specs: [
            "Control: Raspberry Pi (Python/Shell)",
            "ActuaciÃ³n: bomba peristÃ¡ltica + vÃ¡lvulas",
            "SincronÃ­a: OSC/tiempos programados",
            "IluminaciÃ³n: LEDs UV",
            "Montaje: metacrilato + aluminio"
        ],
        date: "2023-10-01"
    },
    {
        id: 17,
        title: "Gino Rubert",
        description: "Cuadros con radar Doppler: la presencia revela imÃ¡genes ocultas por luz interna.",
        image: IMG_BASE + "GinoMain.jpg",
        tags: ["arte", "desarrollos", "luz", "sonido"],
        details:
            "Desarrollo de electrÃ³nica embebida en marcos: sensores Doppler detectan presencia y disparan un sistema de LED con fade in/out que muestra una capa pictÃ³rica oculta. Proyecto expuesto en distintos espacios (p.ej., Tecla Sala, 2023) y en evoluciÃ³n tÃ©cnica continua.",
        specs: [
            "Sensado: radar Doppler de presencia",
            "IluminaciÃ³n: LED de alto CRI",
            "Control: placas a medida (Arduino)",
            "AlimentaciÃ³n: 12 V discreta",
            "IntegraciÃ³n: bastidor/marco"
        ],
        date: "2023-10-01"
    },
    {
        id: 20,
        title: "Multiverso",
        description: "Mural que se â€œpinta con luzâ€: encendido autÃ³nomo por horarios y coreografÃ­a lumÃ­nica.",
        image: IMG_BASE + "multiversoMain.jpg",
        tags: ["arte", "luz"],
        details:
            "InstalaciÃ³n lumÃ­nica autÃ³noma en espacio pÃºblico/comunitario. Secuencias programadas activan sectores del mural en franjas horarias, generando capas visuales dinÃ¡micas sin intervenciÃ³n humana. BaterÃ­a recargable, fÃ¡cil mantenimiento y ajuste de comportamiento por calendario.",
        specs: [
            "Controlador programable (MCU)",
            "CoreografÃ­as LED",
            "TemporizaciÃ³n horaria",
            "AlimentaciÃ³n: baterÃ­a recargable",
            "Modo: autÃ³nomo/portÃ¡til"
        ],
        date: "2023-05-01"
    },
    {
        id: 2,
        title: "Biota",
        description: "Estructura reticular sensible: movimiento del pÃºblico activa paisajes sonoros.",
        image: IMG_BASE + "biotaMain.jpg",
        tags: ["arte", "investigaciÃ³n", "sonido", "luz", "educaciÃ³n"],
        details:
            "InstalaciÃ³n multimedia surgida del programa Bolit Mentor (secundaria de Girona). Integra composiciones de estudiantes activadas por PIR. El audio suena por altavoces y transductores en la estructura, permitiendo percibir la obra por tacto y ampliando la accesibilidad.",
        specs: [
            "MCU: Arduino",
            "Audio: altavoces + transductores",
            "Sensores: PIR + ambiente",
            "Luz: pixel LED",
            "Software: playback/sÃ­ntesis"
        ],
        date: "2023-11-30"
    },
    /*{
      id: 14_2,
      title: "Relics",
      description: "Esculturas cerÃ¡micas tÃ¡ctiles como instrumentos MIDI; interfaz sensible y compacta.",
      image: IMG_BASE + "relicsMain.jpg",
      tags: ["arte", "performance"],
      details:
        "ColaboraciÃ³n con Dania Shihab (SÃ³nar 2025): cerÃ¡micas diseÃ±adas en 3D con discos de cobre y 12 sensores capacitivos MPR121 por pieza. Arduino Micro actÃºa como interfaz MIDI-USB; cada contacto dispara eventos/gestos sonoros en tiempo real. Optimizado para fiabilidad tÃ¡ctil y montaje escÃ©nico.",
      specs: [
        "Interfaz: Arduino Micro (MIDI-USB)",
        "Sensores: MPR121 capacitivos",
        "Electrodos: cobre integrado en cerÃ¡mica",
        "Soft: entorno/DAW tiempo real",
        "DiseÃ±o: modular y escalable"
      ],
      date: "2025-06-01"
    },*/
    {
        id: 22,
        title: "Playing God",
        description: "Biointerfaz plantaâ€“mÃ¡quina: sensores traducen respuestas vegetales a sonido.",
        image: IMG_BASE + "playingGodMain.jpg",
        tags: ["arte", "ciencia", "investigaciÃ³n"],
        details:
            "InvestigaciÃ³n artÃ­stica financiada por OSIC que explora sensibilidad vegetal. Tres dispositivos: (1) sensor suelo/ambiente (pH, EC, NPK, temp., luz, presencia), (2) sensor galvÃ¡nico en hojas para micro-variaciones elÃ©ctricas, (3) mÃ³dulo ambiental de aire (Oâ‚‚/COâ‚‚). TraducciÃ³n sonora (Max/MSP) y registro de reacciones.",
        specs: [
            "Sensores: pH, EC, NPK, temp., luz, presencia",
            "Electrodos: pads galvÃ¡nicos",
            "Soft: Max/MSP",
            "EnergÃ­a: panel solar + baterÃ­a",
            "Datos: logging/visualizaciÃ³n"
        ],
        date: "2022-09-15"
    },
    {
        id: 18,
        title: "Kit Ambiental",
        description: "Kit modular open-source: sensores para campo educativo/ciencia ciudadana.",
        image: IMG_BASE + "kitAmbientalMain.jpg",
        tags: ["ciencia", "educaciÃ³n", "sostenibilidad", "desarrollos"],
        details:
            "Plataforma DIY para observaciÃ³n y registro en exterior: carcasa 3D resistente a intemperie, alimentaciÃ³n solar/baterÃ­a y sensores intercambiables (agua/aire/suelo). Registro local (SD) o envÃ­o BLE/WiFi. Pensado para talleres y trabajo comunitario.",
        specs: [
            "MCU: ESP32",
            "Almacenamiento: microSD",
            "Conectividad: BLE/WiFi",
            "Sensores: DHT22, MQ, TDS, turbidez, etc.",
            "AlimentaciÃ³n: solar o baterÃ­a"
        ],
        date: "2024-07-01"
    },
    {
        id: 10,
        title: "DeCent",
        description: "MÃ³dulo autÃ³nomo para saneamiento/monitoreo de aire. Conjunto de sensores y actuadores conectados vÃ­a bluetooth a una interfaz grÃ¡fica que permite visualizar y guardar datos para investigaciÃ³n cientÃ­fica.",
        image: IMG_BASE + "decentMain.jpg",
        tags: ["ciencia", "sostenibilidad", "investigaciÃ³n", "desarrollos"],
        details:
            "InstalaciÃ³n experimental (decentralized + sensing + sanitation) para contextos rurales/itinerantes. Sensado de gases (metano/COâ‚‚), humedad y temperatura de aire/suelo, logging en SD y operaciÃ³n autÃ³noma con energÃ­a solar. Plataforma para prÃ¡cticas eco-tecnolÃ³gicas.",
        specs: [
            "MCU: ESP32",
            "Sensores: CHâ‚„ (100%), COâ‚‚ (100%), O2, H2, pH",
            "Actuadores: 5 x Bombas PeristÃ¡lticas",
            "Registro: microSD",
            "EnergÃ­a: multivoltaje DC",
            "Formato: caja modular transportable"
        ],
        date: "2023-01-01"
    },
    {
        id: 3,
        title: "a-sync",
        description: "PolifonÃ­a desincronizada: luz y sonido generan patrones fuera de fase.",
        image: IMG_BASE + "async.jpg",
        tags: ["arte", "sonido", "ciencia", "luz"],
        details:
            "InstalaciÃ³n de vibraciÃ³n/azar: transductores convierten vidrios en membranas resonantes. Capas de audio y luz se desfasan para producir pulsos que se alinean/desalinean en el espacio.",
        specs: [
            "Audio: multicanal",
            "Control: MIDI/MaxMSP",
            "IluminaciÃ³n: Esculturas led con software personalizado",
            "ActuaciÃ³n: transductores"
        ],
        date: "2023-02-15"
    },
    {
        id: 4,
        title: "silencios inquietos",
        description: "Granulado de ruido blanco espacializado que esculpe el silencio como materia.",
        image: IMG_BASE + "silenciosInquietosMain.jpg",
        tags: ["arte", "sonido"],
        details:
            "Cinco estructuras sostienen 30 parlantes controlados por algoritmo generativo. La obra desplaza la escucha hacia una experiencia activa del â€˜silencioâ€™ y sugiere el espacio como narrativa sonora.",
        specs: [
            "30 parlantes + 30 relÃ©s",
            "Control: Arduino",
            "Algoritmo: generativo",
            "Audio: granos de ruido blanco",
            "Site: CCK (2019)"
        ],
        date: "2021-12-15"
    },
    {
        id: 5,
        title: "habittat",
        description: "Serie generativa (2015â€“2018): actuadores sonoros/luz moldean la percepciÃ³n del espacio.",
        image: IMG_BASE + "HabittatMain.jpg",
        tags: ["arte", "sonido"],
        details:
            "Intervenciones que sitÃºan actuadores lumÃ­nicos y sonoros para componer secuencias orgÃ¡nicas mediante microcontroladores. Un recorrido que re-entiende el espacio por estÃ­mulos visuales/acÃºsticos.",
        specs: [
            "Algoritmo generativo",
            "Actuadores de luz y golpeadores",
            "Microcontroladores",
            "Formato: site-specific",
            "Periodo: 2015â€“2018"
        ],
        date: "2020-08-15"
    },
    {
        id: 21,
        title: "noias",
        description: "Dispositivos sonoros que detectan la cercanÃ­a del oÃ­do y reproducen grabaciones hechas en ese mismo punto geogrÃ¡fico.",
        image: IMG_BASE + "noiasMain.jpg",
        tags: ["arte", "sonido", "desarrollos"],
        details:
            "Dispositivos autÃ³nomos con Arduino Nano y sensor de ultrasonido que detectan la cercanÃ­a del oÃ­do para activar un altavoz. Cada uno reproduce un audio grabado en ese mismo lugar, conectando presencia fÃ­sica, memoria y territorio a travÃ©s de la escucha.",
        specs: [
            "Sensores: de cercanÃ­a (ultrasonido)",
            "Actuadores: altavoces",
            "Control: Arduino Nano, activaciÃ³n por cercanÃ­a",
            "Ambiente: mapa de la devesa de Salt"
        ],
        date: "2022-09-01"
    },
    {
        id: 7,
        title: "micro-bio",
        description: "Sistema experimental para la captura y reducciÃ³n de COâ‚‚ en espacios interiores.",
        image: IMG_BASE + "microBioMain.JPG",
        tags: ["ciencia", "investigaciÃ³n", "desarrollos"],
        details:
            "Proyecto de investigaciÃ³n cientÃ­fica que integra sensores de COâ‚‚, bombas, electrovÃ¡lvulas y lÃ¡minas resistivas para extraer y almacenar COâ‚‚ del aire interior. Registra datos en tarjeta SD y ofrece visualizaciÃ³n mediante una app en Flutter, incluso en modo offline. Primera fase del proyecto Decent, con enfoque en sostenibilidad y reutilizaciÃ³n de recursos.",
        specs: [
            "MCU: Arduino Mega 2560",
            "Sensores: COâ‚‚ industriales",
            "Actuadores: bombas de aire, electrovÃ¡lvulas, lÃ¡minas resistivas calefactadas",
            "Almacenamiento: tarjeta SD",
            "Conectividad: App Flutter con soporte offline",
            "AlimentaciÃ³n: 12 V",
            "Sistema de captura y almacenamiento de gas"
        ],
        date: "2022-11-03"
    },
    {
        id: 6,
        title: "mutaciones",
        description: "Sistema lumÃ­nico generativo: Max/MSP y Arduino Mega conmutan tubos fluorescentes mediante patrones aleatorios inspirados en el Iâ€‘Ching.",
        image: IMG_BASE + "mutacionesMain.png",
        tags: ["arte", "luz"],
        details:
            "InstalaciÃ³n que conecta Max/MSP con una matriz de relÃ©s controlada por Arduino Mega para encender y apagar tubos fluorescentes. Cada ejecuciÃ³n genera combinaciones diferentes de encendidos, componiendo imÃ¡genes lumÃ­nicas siempre cambiantes. El algoritmo introduce azar y reglas simples para mutar ritmos y composiciones, evocando el Iâ€‘Ching como motor de variaciÃ³n.",
        specs: [
            "MCU: Arduino Mega 2560",
            "Software: Max/MSP (control y secuenciaciÃ³n)",
            "Interfaz: comunicaciÃ³n serial Max â‡„ Arduino",
            "Actuadores: caja de relÃ©s + tubos fluorescentes",
            "Algoritmos: patrones aleatorios/generativos",
        ],
        date: "2022-12-15"
    },
    {
        id: 26_2,
        title: "Interferencias CÃ³smicas",
        description: "Detector DIY de muones + visual/sonificaciÃ³n en tiempo real (Pure Data).",
        image: IMG_BASE + "rayosCosmicosMain.jpg",
        tags: ["arte", "ciencia", "investigaciÃ³n"],
        details:
            "InvestigaciÃ³n sobre rayos cÃ³smicos y su traducciÃ³n sensorial. Prototipo con centelladores y adquisiciÃ³n de datos; los impactos se envÃ­an a Pure Data para generar visuales reactivos y capas sonoras. Proyecto orientado a documentaciÃ³n abierta y replicabilidad.",
        specs: [
            "DetecciÃ³n: centelladores",
            "Control: Arduino Nano",
            "Visual/Sonido: Pure Data",
            "Foco: ciencia ciudadana/DIY",
            "Estado: prototipo en evoluciÃ³n"
        ],
        date: "2024-09-01"
    },
    {
        id: 8,
        title: "IntroducciÃ³n a la programaciÃ³n y la electrÃ³nica",
        description: "Kit/curso progresivo para iniciar en MCU, sensores y control.",
        image: IMG_BASE + "introduccionElectronica.jpg",
        tags: ["educaciÃ³n", "ciencia"],
        details:
            "DiseÃ±o de talleres modulares (2022â€“actualidad) con enfoque DIY y soberanÃ­a tecnolÃ³gica: sensores ambientales, construcciÃ³n de dispositivos interactivos y automatizaciÃ³n con Arduino/ESP32. Adaptable a escuelas, universidades, festivales e instituciones.",
        specs: [
            "MCU: Arduino/ESP32",
            "Componentes: sensores/actuadores",
            "Formato: >15 prÃ¡cticas",
            "Software: libre",
            "MetodologÃ­a: aprendizaje colectivo"
        ],
        date: "2024-12-13"
    },
    {
        id: 11,
        title: "Erik Estany Tigerstorm",
        description: "Soporte tÃ©cnico/AV: adaptaciÃ³n de obras, montaje, sincronÃ­a de pantallas y controladores.",
        image: IMG_BASE + "ErikPantallitasMain.jpg",
        tags: ["arte", "desarrollos", "video"],
        details:
            "Desarrollo/montaje para la expo â€˜Del que pasa a foraâ€™ (Viphoto Fest y Sala AmÃ¡rica): integraciÃ³n de pantallas OLED/HDMI, controladores personalizados, sincronizaciÃ³n y automatizaciÃ³n para funcionamiento continuo.",
        specs: [
            "Control: Raspberry Pi + Arduino",
            "Displays: OLED/HDMI",
            "IntegraciÃ³n: interfaces a medida",
            "SincronizaciÃ³n: playback estable",
            "Servicio: montaje integral"
        ],
        date: "2022-06-01"
    },
    {
        id: 23,
        title: "Aleatoriedades",
        description: "La rama de un Ã¡rbol atrapada en un loop constante. Land-art.",
        image: IMG_BASE + "AleatoriedadesMain.png",
        tags: ["arte", "land-art"],
        details:
            "Tras una tormenta, una rama quedÃ³ atrapada en un ciclo repetitivo: un extremo sujeto a piedras, el otro rebotando sobre el agua. Mi intervenciÃ³n reforzÃ³ su estructura y anclaje para que el movimiento persistiera, extendiendo un instante fortuito hacia una observaciÃ³n prolongada.",
        specs: [
            "UbicaciÃ³n: El VolcÃ¡n, San Luis (Argentina)",
            "Medio: land-art, intervenciÃ³n site-specific",
            "Materiales: rama, piedras, cuerda/refuerzo",
            "TÃ©cnica: ajuste de anclaje y estructura con piedras y madera",
            "DuraciÃ³n: variable, segÃºn condiciones naturales"
        ],
        date: "2018-12-15"
    },
    {
        id: 24,
        title: "LuciÃ©rnagas",
        description: "Luces led con sistema y conexiÃ³n personalizada crea una sinfonÃ­a luminiscente que rinde tributo a las luciÃ©rnagas.",
        image: IMG_BASE + "luciernagasMain.png",
        tags: ["arte", "luz"],
        details:
            "InstalaciÃ³n lumÃ­nica compuesta por LEDs conectados a un sistema de control diseÃ±ado a medida. El conjunto genera pulsos y destellos que evocan el comportamiento de las luciÃ©rnagas, transformando el espacio en una coreografÃ­a de luz que oscila entre lo natural y lo artificial.",
        specs: [
            "MCU: Arduino Nano",
            "Luz: LED",
            "Sensores: fotodiodos",
            "EnergÃ­a: baterÃ­a recargable",
            "Outdoor: IP65"
        ],
        date: "2020-07-15"
    },
    {
        id: 12,
        title: "Dispositivos DomÃ³tica Personalizados",
        description: "Sistemas a medida para control remoto de iluminaciÃ³n, sonido y accesos.",
        image: IMG_BASE + "domoticaMain.jpg",
        tags: ["domÃ³tica", "desarrollos"],
        details:
            "Desarrollo de dispositivos personalizados que requerÃ­a avisos sonoros programados, control de iluminaciÃ³n y apertura/cierre remoto de puertas. El sistema, basado en ESP32, integra reproductor de audio DFPlayer, relÃ©s y cerraduras electromagnÃ©ticas, operando de forma centralizada y adaptable a distintas rutinas horarias.",
        specs: [
            "MCU: ESP32",
            "Audio: DFPlayer Mini + altavoz",
            "Actuadores: relÃ©s + cerraduras electromagnÃ©ticas",
            "Funciones: avisos sonoros programados, control de iluminaciÃ³n, apertura/cierre de puertas",
            "Conectividad: WiFi"
        ],
        date: "2024-06-10"
    },
    {
        id: 13,
        title: "Todo lo que flota tiene que flotar",
        description: "InstalaciÃ³n efÃ­mera de flotabilidad, equilibrio y azar en entorno natural.",
        image: IMG_BASE + "todoLoQueFlotaMain.png",
        tags: ["arte", "land-art"],
        details:
            "Ensayo sobre tensiÃ³n capilar, vasos comunicantes, densidad y formas inestables usando hojas, ramas, piedras, agua y objetos locales. Registro audiovisual y partitura de acciones.",
        specs: [
            "Site: Canet de Adri",
            "Materiales: orgÃ¡nicos/in situ",
            "AcciÃ³n: coreografÃ­as/percusiÃ³n",
            "Documento: video",
            "Formato: efÃ­mero"
        ],
        date: "2020-09-01"
    },
    {
        id: 27,
        title: "Insectodrom",
        description: "Sistema de streaming DIY para hostales de insectos con Raspberry Pi y energÃ­a solar.",
        image: IMG_BASE + "insectodromMain.png",
        tags: ["ciencia", "investigaciÃ³n", "iot", "sostenibilidad", "video", "desarrollos"],
        details:
            "Desarrollo tÃ©cnico para el proyecto Insectodrom del centro de arte contemporÃ¡neo BLOIT, que explora la relaciÃ³n entre humanos, insectos y ciudades. Mi contribuciÃ³n consistiÃ³ en diseÃ±ar e implementar un sistema completo de streaming en vivo para hostales de insectos, utilizando Raspberry Pi con mÃ³dulo de cÃ¡mara CAPI CAM. El sistema transmite 24/7 por Twitch, mostrando la vida de los insectos en tiempo real, y estÃ¡ alimentado completamente por energÃ­a solar. AdemÃ¡s, creÃ© un video tutorial completo que explica paso a paso cÃ³mo replicar este sistema low-cost y DIY para que otros puedan implementar sus propios streams de biodiversidad urbana.",
        specs: [
            "Hardware: Raspberry Pi + mÃ³dulo CAPI CAM",
            "Streaming: transmisiÃ³n 24/7 por Twitch",
            "EnergÃ­a: sistema solar autÃ³nomo",
            "Software: programaciÃ³n personalizada para streaming",
            "DocumentaciÃ³n: video tutorial DIY completo",
            "AplicaciÃ³n: monitoreo de biodiversidad urbana en tiempo real"
        ],
        date: "2023-04-27"
    }
];

// Variables globales
let currentPage = 'home';
let activeFilters = [];
let filteredProjects = [...projects];
// Orden inicial por fecha descendente
filteredProjects = [...projects].sort((a, b) => new Date(b.date) - new Date(a.date));

// InicializaciÃ³n cuando el DOM estÃ¡ listo
document.addEventListener('DOMContentLoaded', function () {
    initializeNavigation();
    initializeTagFilters();
    initializeModal();
    initializeContactForm();
    initializeServicesPage();
    initializeLanguageSelector(); // Llamar la nueva funciÃ³n

    // Renderizado inicial con animaciÃ³n
    setTimeout(() => {
        renderProjectsAnimated();

        // Test directo de las service cards
        const testCards = document.querySelectorAll('.service-card');
        console.log('Test directo - Service cards encontradas:', testCards.length);
        testCards.forEach(card => {
            card.addEventListener('click', function () {
                console.log('Click directo en service card!');
                const serviceType = this.getAttribute('data-service');
                if (serviceType) {
                    navigateToServiceProjects(serviceType);
                }
            });
        });

        // Inicializar highlights clickeables del home
        initializeHomeHighlights();

        // Inicializar menÃº mÃ³vil
        initializeMobileMenu();
    }, 100);

    // Renderizar proyectos recientes despuÃ©s de un poco mÃ¡s de tiempo
    setTimeout(() => {
        console.log('Ejecutando renderRecentProjects...');
        renderRecentProjects();
    }, 300);
});

// NavegaciÃ³n entre pÃ¡ginas
function initializeNavigation() {
    const navItems = document.querySelectorAll('.nav-item');

    navItems.forEach(item => {
        item.addEventListener('click', function (e) {
            e.preventDefault();
            const targetPage = this.getAttribute('data-page');
            console.log('Navegando a:', targetPage);
            navigateToPage(targetPage);

            // Actualizar estado activo
            navItems.forEach(nav => nav.classList.remove('active'));
            this.classList.add('active');

            // Mostrar/ocultar submenu de tags
            toggleTagsSubmenu(targetPage);
        });
    });

    // Inicializar botones CTA del home
    initializeCTAButtons();
}

// FunciÃ³n para inicializar botones CTA del home
function initializeCTAButtons() {
    const ctaButtons = document.querySelectorAll('.cta-button');

    console.log('ğŸ” Inicializando botones CTA...');
    console.log('ğŸ”˜ Botones CTA encontrados:', ctaButtons.length);
    console.log('ğŸ”˜ Botones:', ctaButtons);

    if (ctaButtons.length === 0) {
        console.log('âŒ ERROR: No se encontraron botones CTA');
        return;
    }

    ctaButtons.forEach((button, index) => {
        const targetPage = button.getAttribute('data-page');
        console.log(`ğŸ”˜ BotÃ³n ${index + 1}:`, { button, targetPage, text: button.textContent });

        button.addEventListener('click', function (e) {
            e.preventDefault();
            e.stopPropagation();

            const targetPage = this.getAttribute('data-page');
            console.log('ğŸ–±ï¸ Click en CTA button:', targetPage);
            console.log('ğŸ”˜ BotÃ³n clickeado:', this);

            // Navegar a la pÃ¡gina
            console.log('ğŸ§­ Navegando a pÃ¡gina:', targetPage);
            navigateToPage(targetPage);

            // Actualizar estado activo en la navegaciÃ³n del sidebar
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(nav => nav.classList.remove('active'));
            const targetNav = document.querySelector(`[data-page="${targetPage}"]`);
            if (targetNav) {
                targetNav.classList.add('active');
                console.log('âœ… NavegaciÃ³n activa actualizada');
            } else {
                console.log('âŒ No se encontrÃ³ nav-item para:', targetPage);
            }

            // Mostrar/ocultar submenu de tags si es necesario
            toggleTagsSubmenu(targetPage);
        });

        console.log(`âœ… Event listener agregado al botÃ³n ${index + 1}`);
    });
}

// FunciÃ³n para mostrar/ocultar submenu de tags
function toggleTagsSubmenu(page) {
    const tagsSubmenu = document.getElementById('tags-submenu');
    if (tagsSubmenu) {
        if (page === 'projects') {
            tagsSubmenu.style.display = 'block';
        } else {
            tagsSubmenu.style.display = 'none';
        }
    }
}

// FunciÃ³n para cambiar idioma
function changeLanguage(lang) {
    currentLanguage = lang;

    // Actualizar botones de idioma
    document.querySelectorAll('.language-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    document.querySelector(`[data-lang="${lang}"]`).classList.add('active');

    // Aplicar traducciones
    applyTranslations();
}

// FunciÃ³n para aplicar traducciones
function applyTranslations() {
    const t = translations[currentLanguage];

    // NavegaciÃ³n
    document.querySelectorAll('[data-page="home"]').forEach(el => el.textContent = t.home);
    document.querySelectorAll('[data-page="projects"]').forEach(el => el.textContent = t.projects);
    document.querySelectorAll('[data-page="contact"]').forEach(el => el.textContent = t.contact);
    document.querySelectorAll('[data-page="about"]').forEach(el => el.textContent = t.about);
    document.querySelectorAll('[data-page="services"]').forEach(el => el.textContent = t.services);

    // Home
    const homeTitle = document.querySelector('.home-text h2');
    if (homeTitle) homeTitle.textContent = t.title;
    
    const homeDescription = document.querySelector('.home-description');
    if (homeDescription) homeDescription.textContent = t.description;
    
    const whatIDoTitle = document.querySelector('.home-what-i-do h3');
    if (whatIDoTitle) whatIDoTitle.textContent = t.whatIDo;
    
    const whatIDoText = document.querySelector('.home-what-i-do p');
    if (whatIDoText) whatIDoText.textContent = t.whatIDoText;
    
    const recentProjectsTitle = document.querySelector('.recent-projects h3');
    if (recentProjectsTitle) recentProjectsTitle.textContent = t.recentProjects;
    
    // Home highlights
    const highlightScience = document.querySelector('[data-highlight="ciencia-investigacion"] .highlight-text');
    if (highlightScience) highlightScience.textContent = t.highlightScience;
    
    const highlightArt = document.querySelector('[data-highlight="arte"] .highlight-text');
    if (highlightArt) highlightArt.textContent = t.highlightArt;
    
    const highlightDevelopments = document.querySelector('[data-highlight="desarrollos"] .highlight-text');
    if (highlightDevelopments) highlightDevelopments.textContent = t.highlightDevelopments;
    
    const highlightSustainability = document.querySelector('[data-highlight="sostenibilidad"] .highlight-text');
    if (highlightSustainability) highlightSustainability.textContent = t.highlightSustainability;
    
    // Home CTA buttons
    const ctaButtons = document.querySelectorAll('.home-cta .cta-button');
    ctaButtons.forEach(btn => {
        const page = btn.getAttribute('data-page');
        if (page === 'projects') btn.textContent = t.ctaProjects;
        if (page === 'services') btn.textContent = t.ctaServices;
    });
    
    // Scrolling text
    const scrollingTexts = document.querySelectorAll('.scrolling-text span');
    if (scrollingTexts.length > 0) {
        const scrollingMapEs = {
            'CIENCIA': 'scrollingScience',
            'ARTE': 'scrollingArt',
            'EDUCACIÃ“N': 'scrollingEducation',
            'IOT': 'scrollingIot',
            'SOFTWARE-HARDWARE': 'scrollingSoftware',
            'SENSORIZACIÃ“N': 'scrollingSensors',
            'DIGITALIZACIÃ“N': 'scrollingDigital',
            'PROTOTIPADO': 'scrollingPrototyping',
            'OPEN-SOURCE': 'scrollingOpenSource',
            'DIY-DIWO': 'scrollingDiy',
            'DOMÃ“TICA': 'scrollingDomotics',
            'SISTEMAS-EMBEBIDOS': 'scrollingEmbedded',
            'INVESTIGACIÃ“N': 'scrollingResearch'
        };
        
        const scrollingMapEn = {
            'SCIENCE': 'scrollingScience',
            'ART': 'scrollingArt',
            'EDUCATION': 'scrollingEducation',
            'IOT': 'scrollingIot',
            'SOFTWARE-HARDWARE': 'scrollingSoftware',
            'SENSORIZATION': 'scrollingSensors',
            'DIGITIZATION': 'scrollingDigital',
            'PROTOTYPING': 'scrollingPrototyping',
            'OPEN-SOURCE': 'scrollingOpenSource',
            'DIY-DIWO': 'scrollingDiy',
            'HOME AUTOMATION': 'scrollingDomotics',
            'EMBEDDED SYSTEMS': 'scrollingEmbedded',
            'RESEARCH': 'scrollingResearch'
        };
        
        scrollingTexts.forEach(span => {
            const originalText = span.textContent.trim();
            const map = currentLanguage === 'es' ? scrollingMapEs : scrollingMapEn;
            const translationKey = map[originalText];
            if (translationKey && t[translationKey]) {
                span.textContent = t[translationKey];
            }
        });
    }
    
    // Re-renderizar proyectos si estamos en la pÃ¡gina de proyectos o en el home
    if (currentPage === 'projects' || currentPage === 'home') {
        if (currentPage === 'projects') {
            renderProjectsAnimated();
        } else if (currentPage === 'home') {
            renderRecentProjects();
        }
    }

    // PÃ¡ginas
    document.querySelector('#projects-page h1').textContent = t.projectsTitle;
    document.querySelector('#projects-page .intro p').textContent = t.projectsIntro;
    document.querySelector('#services-page h1').textContent = t.servicesTitle;
    document.querySelector('#services-page .services-intro p').textContent = t.servicesIntro;
    document.querySelector('#contact-page h1').textContent = t.contactTitle;
    document.querySelector('#about-page h1').textContent = t.aboutTitle;

    // Servicios
    document.querySelector('.service-card:nth-child(1) h3').textContent = t.scienceResearch;
    document.querySelector('.service-card:nth-child(1) p').textContent = t.scienceResearchText;
    document.querySelector('.service-card:nth-child(2) h3').textContent = t.digitalArt;
    document.querySelector('.service-card:nth-child(2) p').textContent = t.digitalArtText;
    document.querySelector('.service-card:nth-child(3) h3').textContent = t.developments;
    document.querySelector('.service-card:nth-child(3) p').textContent = t.developmentsText;
    document.querySelector('.service-card:nth-child(4) h3').textContent = t.sustainability;
    document.querySelector('.service-card:nth-child(4) p').textContent = t.sustainabilityText;

    // Tags
    document.querySelector('.tags-submenu h3').textContent = t.filterByTags;

    // Contacto
    document.querySelector('.contact-info strong:first-of-type').textContent = t.email + ':';
    document.querySelector('.contact-info strong:last-of-type').textContent = t.portfolioArt + ':';
    document.querySelector('label[for="name"]').textContent = t.name;
    document.querySelector('label[for="message"]').textContent = t.message;
    document.querySelector('button[type="submit"]').textContent = t.send;
}

function navigateToPage(page) {
    console.log('ğŸ” navigateToPage llamada con:', page);

    // Ocultar todas las pÃ¡ginas
    const pages = document.querySelectorAll('.page');
    console.log('ğŸ“„ PÃ¡ginas encontradas:', pages.length);
    pages.forEach(p => {
        p.classList.add('hidden');
        console.log('ğŸš« Ocultando pÃ¡gina:', p.id);
    });

    // Mostrar la pÃ¡gina seleccionada
    const targetPage = document.getElementById(`${page}-page`);
    console.log('ğŸ¯ PÃ¡gina objetivo:', targetPage);

    if (targetPage) {
        targetPage.classList.remove('hidden');
        console.log('âœ… Mostrando pÃ¡gina:', targetPage.id);
        currentPage = page;

        // Scroll al inicio de la pÃ¡gina
        window.scrollTo({
            top: 0,
            left: 0,
            behavior: 'smooth'
        });

        // Solo reinicializar menÃº mÃ³vil (sin cleanup problemÃ¡tico)
        setTimeout(() => {
            initializeMobileMenu();
        }, 100);
    } else {
        console.log('âŒ ERROR: No se encontrÃ³ la pÃ¡gina:', `${page}-page`);
    }
}

// Sistema de filtros por tags
function initializeTagFilters() {
    const tagButtons = document.querySelectorAll('.tag-filter');

    tagButtons.forEach(button => {
        // Remover event listeners existentes para evitar duplicaciÃ³n
        const newButton = button.cloneNode(true);
        button.parentNode.replaceChild(newButton, button);

        newButton.addEventListener('click', function () {
            const tag = this.getAttribute('data-tag');
            toggleTagFilter(tag, this);
        });
    });
}

function toggleTagFilter(tag, buttonElement) {
    const index = activeFilters.indexOf(tag);

    if (index > -1) {
        // Remover filtro
        activeFilters.splice(index, 1);
        buttonElement.classList.remove('active');
    } else {
        // Agregar filtro
        activeFilters.push(tag);
        buttonElement.classList.add('active');
    }

    filterProjects();
}

function filterProjects() {
    // Primero, animar la salida de los elementos actuales
    const currentCards = document.querySelectorAll('.project-card');

    // Agregar clase de fade-out a todos los elementos actuales
    currentCards.forEach((card, index) => {
        setTimeout(() => {
            card.classList.add('fade-out');
        }, index * 50); // Retraso escalonado
    });

    // DespuÃ©s de que termine la animaciÃ³n de salida, filtrar y mostrar nuevos elementos
    setTimeout(() => {
        if (activeFilters.length === 0) {
            // Sin filtros â†’ mostrar todos los proyectos ordenados por fecha descendente
            filteredProjects = [...projects].sort((a, b) => new Date(b.date) - new Date(a.date));
        } else {
            // Filtrar y ordenar por fecha descendente
            filteredProjects = projects
                .filter(project => project.tags.some(tag => activeFilters.includes(tag)))
                .sort((a, b) => new Date(b.date) - new Date(a.date));
        }

        renderProjectsAnimated();
    }, currentCards.length * 50 + 200); // Esperar a que termine la animaciÃ³n de salida
}

// Renderizado de proyectos (versiÃ³n inicial sin animaciones)
function renderProjects() {
    const container = document.getElementById('projects-container');

    if (filteredProjects.length === 0) {
        container.innerHTML = `<p style="text-align: center; color: #666;">${translations[currentLanguage].noProjectsFound}</p>`;
        return;
    }

    container.innerHTML = filteredProjects
        .map(
            project => `
          <div class="project-card" data-project-id="${project.id}">
            <div class="project-image">
              <img src="${project.image}" alt="${project.title}" loading="lazy">
            </div>
            <h3 class="project-title">${project.title}</h3>
            <p class="project-description">${getProjectText(project, 'description')}</p>
            <div class="project-tags">
              ${project.tags.map(tag => `<span class="project-tag">${tag}</span>`).join('')}
            </div>
          </div>
        `
        )
        .join('');

    addProjectCardListeners();
}

// Renderizado animado de proyectos
function renderProjectsAnimated() {
    const container = document.getElementById('projects-container');

    if (filteredProjects.length === 0) {
        container.innerHTML = `<p style="text-align: center; color: #666; opacity: 0;" class="no-projects">${translations[currentLanguage].noProjectsFound}</p>`;
        // Animar la entrada del mensaje
        setTimeout(() => {
            const message = container.querySelector('.no-projects');
            if (message) {
                message.style.transition = 'opacity 0.5s ease';
                message.style.opacity = '1';
            }
        }, 100);
        return;
    }

    // Crear elementos con opacidad 0 para animaciÃ³n de entrada
    container.innerHTML = filteredProjects
        .map(
            project => `
          <div class="project-card" data-project-id="${project.id}" style="opacity: 0; transform: scale(0.8) translateY(30px);">
            <div class="project-image">
              <img src="${project.image}" alt="${project.title}" loading="lazy">
            </div>
            <h3 class="project-title">${project.title}</h3>
            <p class="project-description">${getProjectText(project, 'description')}</p>
            <div class="project-tags">
              ${project.tags.map(tag => `<span class="project-tag">${tag}</span>`).join('')}
            </div>
          </div>
        `
        )
        .join('');

    // Animar la entrada de cada card con retraso escalonado
    const newCards = container.querySelectorAll('.project-card');
    newCards.forEach((card, index) => {
        setTimeout(() => {
            card.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
            card.style.opacity = '1';
            card.style.transform = 'scale(1) translateY(0) rotate(0deg)';

            // Agregar una pequeÃ±a rotaciÃ³n aleatoria durante la animaciÃ³n para mÃ¡s organicidad
            const randomRotation = (Math.random() - 0.5) * 2; // Entre -1 y 1 grado
            card.style.transform = `scale(1) translateY(0) rotate(${randomRotation}deg)`;

            setTimeout(() => {
                card.style.transform = 'scale(1) translateY(0) rotate(0deg)';
            }, 300);
        }, index * 100 + 50); // Retraso escalonado para entrada orgÃ¡nica
    });

    addProjectCardListeners();
}

// FunciÃ³n auxiliar para agregar event listeners a las cards
function addProjectCardListeners() {
    const projectCards = document.querySelectorAll('.project-card');
    projectCards.forEach(card => {
        card.addEventListener('click', function () {
            const projectId = parseInt(this.getAttribute('data-project-id'));
            openProjectModal(projectId);
        });
    });
}

// Sistema de modal para proyectos expandidos
function initializeModal() {
    const modal = document.getElementById('project-modal');
    const closeButton = document.querySelector('.close-modal');

    if (closeButton) {
        closeButton.addEventListener('click', closeModal);
    }

    if (modal) {
        modal.addEventListener('click', function (e) {
            if (e.target === modal) {
                closeModal();
            }
        });
    }

    // Cerrar modal con ESC
    document.addEventListener('keydown', function (e) {
        const m = document.getElementById('project-modal');
        if (e.key === 'Escape' && m && !m.classList.contains('hidden')) {
            closeModal();
        }
    });
}

function openProjectModal(projectId) {
    const project = projects.find(p => p.id === projectId);
    if (!project) return;

    const modalBody = document.getElementById('modal-body');
    if (modalBody) {
        modalBody.innerHTML = `
        <div class="modal-project-content">
          <h2>${project.title}</h2>
          <div class="project-image">
            <img src="${project.image}" alt="${project.title}">
          </div>
          <div class="project-details">
            ${getProjectText(project, 'details')}
          </div>
          <div class="project-specs">
            <h3>${translations[currentLanguage].technicalSpecs}</h3>
            <ul>
              ${getProjectText(project, 'specs').map(spec => `<li>â€¢ ${spec}</li>`).join('')}
            </ul>
          </div>
          <div class="project-tags">
            ${project.tags.map(tag => `<span class="project-tag">${tag}</span>`).join('')}
          </div>
        </div>
      `;
    }

    const modal = document.getElementById('project-modal');
    if (modal) {
        modal.classList.remove('hidden');
    }
    document.body.style.overflow = 'hidden'; // Prevenir scroll del body
}

function closeModal() {
    const modal = document.getElementById('project-modal');
    if (modal) {
        modal.classList.add('hidden');
    }
    document.body.style.overflow = 'auto'; // Restaurar scroll del body
}

// Formulario de contacto
function initializeContactForm() {
    const form = document.querySelector('.contact-form');
    if (!form) return;

    form.addEventListener('submit', function (e) {
        e.preventDefault();

        const formData = new FormData(form);
        const data = {
            name: formData.get('name'),
            email: formData.get('email'),
            message: formData.get('message')
        };

        // Simular envÃ­o del formulario
        console.log('Datos del formulario:', data);

        // Mostrar mensaje de confirmaciÃ³n
        alert('Â¡Gracias por tu mensaje! Te contactarÃ© pronto.');

        // Limpiar formulario
        form.reset();
    });
}

// Funciones utilitarias
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}


function setHamburgerAria(isOpen) {
    const buttons = document.querySelectorAll('.mobile-menu-btn');
    buttons.forEach(btn => {
        btn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
        btn.setAttribute('aria-label', isOpen ? 'Cerrar menÃº' : 'Abrir menÃº');
    });
}
let iniciado = false
// Responsive: manejo del menÃº en mÃ³vil - VERSIÃ“N SIMPLIFICADA
function initializeMobileMenu() {
    if (iniciado) return;
    iniciado = true
    const sidebar = document.querySelector('.sidebar');
    const mainContent = document.querySelector('.main-content');
    console.log("initializeMobileMenu")
    if (sidebar) {
        // Crear overlay si no existe
        let overlay = document.querySelector('.sidebar-overlay');
        if (!overlay) {
            overlay = document.createElement('div');
            overlay.className = 'sidebar-overlay';
            document.body.appendChild(overlay);
        }

        // Agregar event listeners a todos los botones hamburguesa
        const mobileMenuBtns = document.querySelectorAll('.mobile-menu-btn');
        mobileMenuBtns.forEach(btn => {
            btn.addEventListener('click', function (e) {
                e.preventDefault();
                e.stopPropagation();
                console.log('Hamburguesa clickeada!', this.id);
                toggleSidebar();
            });
        });

        // Cerrar menÃº al tocar el overlay
        overlay.addEventListener('click', function () {
            console.log('Overlay clickeado, cerrando menÃº');
            closeSidebar();
        });

        // Cerrar menÃº al tocar en el contenido principal
        mainContent.addEventListener('click', function () {
            if (sidebar.classList.contains('open')) {
                console.log('Contenido principal clickeado, cerrando menÃº');
                closeSidebar();
            }
        });

        // Cerrar menÃº al tocar en los botones de navegaciÃ³n
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
            item.addEventListener('click', function () {
                console.log('Nav item clickeado, cerrando menÃº');
                closeSidebar();

                // Remover clase active de todos los nav items
                navItems.forEach(nav => nav.classList.remove('active'));
                // Agregar clase active al item clickeado
                this.classList.add('active');
            });
        });

        // Cerrar menÃº al tocar en los botones de idioma
        const languageBtns = document.querySelectorAll('.language-btn');
        languageBtns.forEach(btn => {
            btn.addEventListener('click', function () {
                console.log('Language btn clickeado, cerrando menÃº');
                closeSidebar();
            });
        });

        // Cerrar menÃº al tocar en los filtros de tags
        const tagFilters = document.querySelectorAll('.tag-filter');
        tagFilters.forEach(filter => {
            filter.addEventListener('click', function () {
                console.log('Tag filter clickeado, cerrando menÃº');
                closeSidebar();
            });
        });

        // Cerrar menÃº con ESC
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape' && sidebar.classList.contains('open')) {
                console.log('ESC presionado, cerrando menÃº');
                closeSidebar();
            }
        });

        console.log('MenÃº mÃ³vil inicializado correctamente con', mobileMenuBtns.length, 'botones hamburguesa');
    } else {
        console.log('Error: No se encontrÃ³ el sidebar');
        console.log('sidebar:', sidebar);
    }
}

function toggleSidebar() {
    const sidebar = document.querySelector('.sidebar');
    const overlay = document.querySelector('.sidebar-overlay');
    const mainContent = document.querySelector('.main-content');

    console.log('toggleSidebar llamado');
    console.log('Estado actual del sidebar:', sidebar.classList.contains('open'));

    if (sidebar.classList.contains('open')) {
        console.log('Cerrando sidebar...');
        closeSidebar();
    } else {
        console.log('Abriendo sidebar...');
        openSidebar();
    }
}

function openSidebar() {
    const sidebar = document.querySelector('.sidebar');
    const overlay = document.querySelector('.sidebar-overlay');
    const mainContent = document.querySelector('.main-content');

    console.log('Abriendo sidebar...');
    sidebar.classList.add('open');
    overlay.classList.add('open');
    mainContent.classList.add('sidebar-open');
    document.body.classList.add('menu-open');
    setHamburgerAria(true);
    console.log('Sidebar abierto, clases:', sidebar.classList.toString());
}

function closeSidebar() {
    const sidebar = document.querySelector('.sidebar');
    const overlay = document.querySelector('.sidebar-overlay');
    const mainContent = document.querySelector('.main-content');

    console.log('Cerrando sidebar...');
    sidebar.classList.remove('open');
    overlay.classList.remove('open');
    mainContent.classList.remove('sidebar-open');
    document.body.classList.remove('menu-open');
    setHamburgerAria(false);
    console.log('Sidebar cerrado, clases:', sidebar.classList.toString());
}

// FunciÃ³n para limpiar event listeners duplicados (simplificada)
function cleanupEventListeners() {
    // Por ahora solo limpiamos la consola
    console.log('Event listeners limpiados');
}


// FunciÃ³n para renderizar proyectos recientes en el home
function renderRecentProjects() {
    const recentContainer = document.getElementById('recent-projects-container');
    console.log('Buscando contenedor de proyectos recientes:', recentContainer);
    if (!recentContainer) {
        console.log('No se encontrÃ³ el contenedor de proyectos recientes');
        return;
    }

    console.log('Total de proyectos disponibles:', projects.length);
    console.log('Proyectos:', projects);

    // Obtener los 3 Ãºltimos proyectos (ordenados por fecha)
    let recentProjects;
    try {
        recentProjects = [...projects]
            .sort((a, b) => new Date(b.date) - new Date(a.date))
            .slice(0, 3);
    } catch (error) {
        console.log('Error ordenando por fecha, tomando primeros 3 proyectos:', error);
        recentProjects = projects.slice(0, 3);
    }

    console.log('Proyectos recientes seleccionados:', recentProjects);
    if (recentProjects.length === 0) {
        console.log('No hay proyectos recientes');
        return;
    }

    recentContainer.innerHTML = recentProjects
        .map(project => `
            <div class="project-card recent" data-project-id="${project.id}">
                <div class="project-image">
                    <img src="${project.image}" alt="${project.title}" loading="lazy">
                </div>
                <h3 class="project-title">${project.title}</h3>
                <p class="project-description">${project.description}</p>
                <div class="project-tags">
                    ${project.tags.map(tag => `<span class="project-tag">${tag}</span>`).join('')}
                </div>
            </div>
        `)
        .join('');

    // Agregar event listeners a las cards recientes
    const recentCards = recentContainer.querySelectorAll('.project-card');
    recentCards.forEach(card => {
        card.addEventListener('click', function () {
            const projectId = parseInt(this.getAttribute('data-project-id'));
            openProjectModal(projectId);
        });
    });
}

// FunciÃ³n para inicializar la pÃ¡gina de servicios
function initializeServicesPage() {
    const contactLinks = document.querySelectorAll('.contact-link');

    contactLinks.forEach(link => {
        link.addEventListener('click', function (e) {
            e.preventDefault();
            const targetPage = this.getAttribute('data-page');
            navigateToPage(targetPage);

            // Actualizar estado activo en la navegaciÃ³n
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(nav => nav.classList.remove('active'));
            const targetNav = document.querySelector(`[data-page="${targetPage}"]`);
            if (targetNav) {
                targetNav.classList.add('active');
            }
        });
    });

    // Inicializar cards de servicios clickeables
    initializeServiceCards();
}

// FunciÃ³n para inicializar el selector de idioma
function initializeLanguageSelector() {
    const languageBtns = document.querySelectorAll('.language-btn');

    languageBtns.forEach(btn => {
        // Remover event listeners existentes para evitar duplicaciÃ³n
        const newBtn = btn.cloneNode(true);
        btn.parentNode.replaceChild(newBtn, btn);

        newBtn.addEventListener('click', function () {
            const lang = this.getAttribute('data-lang');
            changeLanguage(lang);
        });
    });
}

// Inicializar cards de servicios clickeables
function initializeServiceCards() {
    const serviceCards = document.querySelectorAll('.service-card.clickable');
    console.log('Service cards encontradas:', serviceCards.length);

    if (serviceCards.length === 0) {
        console.log('No se encontraron service cards con clase clickable');
        // Intentar con solo service-card
        const allServiceCards = document.querySelectorAll('.service-card');
        console.log('Total de service cards encontradas:', allServiceCards.length);
    }

    serviceCards.forEach(card => {
        console.log('Agregando click listener a:', card.getAttribute('data-service'));
        card.addEventListener('click', function (e) {
            e.preventDefault();
            e.stopPropagation();
            console.log('Click en service card:', this.getAttribute('data-service'));
            const serviceType = this.getAttribute('data-service');
            navigateToServiceProjects(serviceType);
        });
    });
}

// FunciÃ³n para navegar a proyectos con tags filtrados segÃºn el servicio
function navigateToServiceProjects(serviceType) {
    // Navegar a la pÃ¡gina de proyectos
    navigateToPage('projects');

    // Actualizar estado activo en la navegaciÃ³n
    const navItems = document.querySelectorAll('.nav-item');
    navItems.forEach(nav => nav.classList.remove('active'));
    const projectsNav = document.querySelector('[data-page="projects"]');
    if (projectsNav) {
        projectsNav.classList.add('active');
    }

    // Mostrar submenu de tags
    toggleTagsSubmenu('projects');

    // Filtrar por tags segÃºn el servicio
    setTimeout(() => {
        filterByService(serviceType);
    }, 100);
}

// FunciÃ³n para filtrar proyectos segÃºn el servicio
function filterByService(serviceType) {
    const tagFilters = document.querySelectorAll('.tag-filter');

    // Limpiar filtros activos
    tagFilters.forEach(filter => filter.classList.remove('active'));

    // Activar tags segÃºn el servicio
    switch (serviceType) {
        case 'ciencia-investigacion':
            activateTags(['ciencia', 'investigaciÃ³n', 'iot', 'sensores']);
            break;
        case 'arte-digital':
            activateTags(['arte', 'desarrollos', 'sonido', 'luz']);
            break;
        case 'desarrollos':
            activateTags(['desarrollos', 'investigaciÃ³n', 'ciencia']);
            break;
        case 'sostenibilidad-educacion':
            activateTags(['sostenibilidad', 'educaciÃ³n']);
            break;
    }
}

// FunciÃ³n para activar tags especÃ­ficos
function activateTags(tagsToActivate) {
    const tagFilters = document.querySelectorAll('.tag-filter');

    tagFilters.forEach(filter => {
        const tag = filter.getAttribute('data-tag');
        if (tagsToActivate.includes(tag)) {
            filter.classList.add('active');
        }
    });

    // Simular click en los tags activados para filtrar proyectos
    tagsToActivate.forEach(tagName => {
        const tagFilter = document.querySelector(`[data-tag="${tagName}"]`);
        if (tagFilter) {
            // Simular el evento de click para activar el filtro
            tagFilter.click();
        }
    });
}

// FunciÃ³n para inicializar las highlights clickeables del home
function initializeHomeHighlights() {
    const highlightItems = document.querySelectorAll('.highlight-item.clickable');
    console.log('Home highlights encontradas:', highlightItems.length);

    highlightItems.forEach(item => {
        item.addEventListener('click', function () {
            const highlightType = this.getAttribute('data-highlight');
            console.log('Click en highlight:', highlightType);
            navigateToHighlightProjects(highlightType);
        });
    });
}

// FunciÃ³n para navegar a proyectos segÃºn el highlight del home
function navigateToHighlightProjects(highlightType) {
    // Navegar a la pÃ¡gina de proyectos
    navigateToPage('projects');

    // Actualizar estado activo en la navegaciÃ³n
    const navItems = document.querySelectorAll('.nav-item');
    navItems.forEach(nav => nav.classList.remove('active'));
    const projectsNav = document.querySelector('[data-page="projects"]');
    if (projectsNav) {
        projectsNav.classList.add('active');
    }

    // Mostrar submenu de tags
    toggleTagsSubmenu('projects');

    // Filtrar por tags segÃºn el highlight
    setTimeout(() => {
        filterByHighlight(highlightType);
    }, 100);
}

// FunciÃ³n para filtrar proyectos segÃºn el highlight del home
function filterByHighlight(highlightType) {
    const tagFilters = document.querySelectorAll('.tag-filter');

    // Limpiar filtros activos
    tagFilters.forEach(filter => filter.classList.remove('active'));

    // Activar tags segÃºn el highlight
    switch (highlightType) {
        case 'ciencia-investigacion':
            activateTags(['ciencia', 'investigaciÃ³n', 'iot', 'sensores']);
            break;
        case 'arte-interactivo':
            activateTags(['arte', 'interactivo', 'sonido', 'luz']);
            break;
        case 'desarrollos':
            activateTags(['desarrollos', 'investigaciÃ³n', 'ciencia']);
            break;
        case 'sostenibilidad':
            activateTags(['sostenibilidad', 'educaciÃ³n']);
            break;
    }
}


// Exportar funciones para uso global si es necesario
window.NIXPortfolio = {
    navigateToPage,
    toggleTagFilter,
    openProjectModal,
    closeModal
};